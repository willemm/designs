<!DOCTYPE html>
<html>
<head>
    <title>Cohort</title>
    <meta charset="utf-8">
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width">
</head>
<body>
<div id="cohort">
</div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
var size = 450
var circleCCW = size - 12
var circleCW = size - 73
var border = size - 82
var bordercol = "#bcd"

var textcol = "#345"
var uppertext = 'ONGSTRAY ALONAY'
var lowertext = 'ERSTRONGAY OGETHERTAY'

var planetradius = 60
var planetoffset = 20
var planetcolor = "#46f"

var sunradius = 40
var edge = 3
var sunintersect = sunradius-5
var suncolor = "#fff"
var sunrays = 7
var inangle = 10
var outangle = 15

var starpoints = 4
var starouter = 20
var starinner = 10
var startopangle = 0
var starcolor = "#fff"

var sunY = 0

function draw_svg()
{
  var svg = `
<svg id="cohort" width="800" height="800" xmlns="http://www.w3.org/2000/svg"
    viewBox="-${size} -${size} ${size*2} ${size*2}" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <path id="circleCW" fill="black" stroke="${bordercol}" style="stroke-width:15" d="
      M 0 ${circleCW}
      a ${circleCW} ${circleCW} 0 0 1  0 -${2*circleCW}
      a ${circleCW} ${circleCW} 0 0 1  0  ${2*circleCW}
      Z
    " />
    <path id="circleCCW" fill="black" stroke="${bordercol}" style="stroke-width:15" d="
      M 0 -${circleCCW} 
      a ${circleCCW} ${circleCCW} 0 0 0  0  ${2*circleCCW}
      a ${circleCCW} ${circleCCW} 0 0 0  0 -${2*circleCCW}
      Z
    " />
    ${star()}
  </defs>
  <circle cs="0" cy="0" r="${size}" fill="black" />
  <path fill="${bordercol}" d="
    M -${border} 0
    a ${border} ${border} 0 0 1  ${border*2} 0
    a ${border} ${border} 0 0 1 -${border*2} 0
    Z
    M -${size} 0
    a ${size} ${size} 0 0 0  ${size*2} 0
    a ${size} ${size} 0 0 0 -${size*2} 0
    Z
  " />

  <text fill="${textcol}" font-size="84" style="font-family: arial;" font-weight="bold" letter-spacing="4" word-spacing="30">
    <textPath xlink:href="#circleCW" text-anchor="middle" startOffset="50%">
      ${uppertext}
    </textPath>
  </text>
  <text fill="${textcol}" font-size="84" style="font-family: arial;" font-weight="bold" letter-spacing="10" word-spacing="20">
    <textPath xlink:href="#circleCCW" text-anchor="middle" startOffset="50%">
      ${lowertext}
    </textPath>
  </text>
${planet()}
${sun()}
${stars()}
${crown()}

</svg>
`

  $('#cohort').html(svg)
  console.log(svg)
}

function planet(color=planetcolor, radius=planetradius, offset=planetoffset)
{
  return `
    <path id="planet" fill="${color}" d="
      M -${radius} ${offset}
      a ${radius} ${radius} 0 0 1  ${radius*2} 0
      a ${radius} ${radius} 0 0 1 -${radius*2} 0
      Z
    " />`
}

function sun(radius=sunradius, edgeradius=planetradius+edge,
             intersectX=sunintersect, offset=planetoffset, color=suncolor)
{
  var intersectY = -Math.sqrt(edgeradius*edgeradius - intersectX*intersectX) + offset
  sunY = Math.sqrt(radius*radius - intersectX*intersectX) + intersectY
  intersectY = intersectY.toFixed(1)
  return `
    <path id="sun" fill="${suncolor}" d="
      M -${intersectX} ${intersectY}
      A ${radius} ${radius} 0 0 1  ${intersectX} ${intersectY}
      A ${edgeradius} ${edgeradius} 0 0 0 -${intersectX} ${intersectY}
      Z
    " />`
}

function crown(inan=inangle, outan=outangle, inr=sunradius+edge,
               outr=border-edge, sunoffset=sunY, color=suncolor, rays=sunrays)
{
  var svg = []
  for (var step = -((sunrays-1)); step <= ((sunrays-1)); step += 2) {
    svg.push(crownray((sunrays+1)/2, step, inan, outan, inr, outr, sunoffset, color))
  }
  return svg.join("\n")
}

function crownray(idoffs, step, inan, outan, inr, outr, sunoffset, color)
{
  var ian1 = inan*(Math.PI/180)*(step-0.5)
  var ian2 = inan*(Math.PI/180)*(step+0.5)
  var oan1 = outan*(Math.PI/180)*(step-0.5)
  var oan2 = outan*(Math.PI/180)*(step+0.5)
  return `
    <path id="crownray${idoffs+step}" fill="${color}" d="
    M ${inr * Math.sin(ian1)} ${(-inr * Math.cos(ian1) + sunoffset).toFixed(1)}
    A ${inr} ${inr} 0 0 1  ${inr * Math.sin(ian2)} ${(-inr * Math.cos(ian2) + sunoffset).toFixed(1)}
    L ${outr * Math.sin(oan2)} ${-outr * Math.cos(oan2)}
    A ${outr} ${outr} 0 0 0  ${outr * Math.sin(oan1)} ${-outr * Math.cos(oan1)}
    Z
  " />`
}

function star(points=starpoints, outer=starouter, inner=starinner, angle=startopangle, color=starcolor)
{
  var svg = [`<path id="star" fill="${color}" d="`]
  cmd = 'M'
  for (pt = 0; pt < points; pt++) {
    an = (angle + (pt * 360)/points) * Math.PI/180
    svg.push(`${cmd} ${(Math.sin(an)*outer).toFixed(1)} ${(Math.cos(an)*outer).toFixed(1)}`)
    an = (angle + ((pt+0.5) * 360)/points) * Math.PI/180
    cmd = 'L'
    svg.push(`${cmd} ${(Math.sin(an)*inner).toFixed(1)} ${(Math.cos(an)*inner).toFixed(1)}`)
  }
  svg.push('Z','" />')
  return svg.join("\n")
}

function stars()
{
  var positions = [
    -270, 100,
    -210, 80,
    -150, 50,
    -220, 130,
    -140, 120,
    -130, 180,

    -80, 250,
    -20, 200,

    150, 110,
    220, 60,
    140, 200,
    200, 140
  ]
  var svg = []
  for (var st = 0; st < positions.length; st += 2) {
    svg.push(`    <use xlink:href="#star" x="${positions[st]}" y="${positions[st+1]}" />\n`)
  }
  return svg.join("\n")
}

draw_svg()
</script>
</html>
